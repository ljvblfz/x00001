<form method="get" name="xmPadDeviceDownloadSearchForm" action="/rs/xmPadDevice" onsubmit="return false;" >
	<input type="hidden" name="pageNum" value="1" />
	<div class="pageHeader">
		<div class="searchBar">
			<ul class="searchContent">
				<li>
					<label>资产编号：</label>
					<input type="text" name="xmpdCode" value=""/>
				</li> 
			</ul>
			<div class="subBar">
				<ul>						
					<li><div class="buttonActive"><div class="buttonContent"><button type="button" onclick="xmPadDeviceDownloadSearch({pageNum:1})">查询</button></div></div></li>
					<li><div class="buttonActive"><div class="buttonContent"><button type="button" onclick="javascript:findName('xmPadDeviceDownloadSearchForm')[0].reset()">清空</button></div></div></li>
				</ul>
			</div>
		</div>
	</div>
</form>

<div class="pageContent">

	<div class="panelBar">
		<ul class="toolBar"> 
			<li><a class="edit"  rel="userNav2" href="javascript:xmPadDeviceDownloadDownload();"     title="下载设备信息"   		multiable="no" warn="请选择一条记录"><span>下载设备信息</span></a></li>
			<!--
			<li class="line">line</li>
			<li><a class="edit"  rel="userNav2" href="javascript:xmPadCompanyDownloadDownload();"     title="下载公司信息"   		multiable="no" warn="请选择一条记录"><span>下载公司信息</span></a></li>
			-->
		</ul>
	</div>
	
	<table class="table" layoutH="138" width="100%">
		<thead>
			<tr  searchMethod="xmPadDeviceDownloadSearch">
						<th width="22"><input type="checkbox" group="xmpdGuids" class="checkboxCtrl"></th>
						<th width="60" orderField="xmpdCode">资产编号</th>
						<th width="60" orderField="xmpdDeviceId">物理编号</th>
						<th width="60" orderField="xmpdDeviceSpec">设备规格</th>
						<th width="60" orderField="xmpdHardwareVersion">硬件版本</th>
						<th width="60" orderField="xmpdSoftwareVersion">软件版本</th>
						<th width="60" orderField="xmpdStatus">设备状态</th> 
						<th width="60" orderField="xmpdType">设备类型</th>  
			</tr>
		</thead>
		<tbody>
			<tr name="xmPadDeviceDownloadTrTemplate" target="slt_uid">
						<td name="xmpdGuid" type="check"><input name="xmpdGuids" value="" type="checkbox"></td>
						<td name="xmpdCode"></td>
						<td name="xmpdDeviceId"></td>
						<td name="xmpdDeviceSpec"></td>
						<td name="xmpdHardwareVersion"></td>
						<td name="xmpdSoftwareVersion"></td>
						<td name="xmpdStatusLabel"></td> 
						<td name="xmpdTypeLabel"></td> 
				
			</tr>
		</tbody>
	</table>
	
	<div class="panelBar">
		<div class="pages">
			<span>显示</span>
			<select class="combox" name="numPerPage" onchange="xmPadDeviceDownloadSearch({numPerPage:this.value,pageNum:1})">
				<option value="10">10</option>
				<option value="40">40</option>
				<option value="100">100</option>
				<option value="200">200</option>
			</select>
			<span name="xmPadDeviceDownloadCountDiv">条，共-条</span>
		</div>
		<div name="xmPadDeviceDownloadPageBar" class="pagination" searchMethod="xmPadDeviceDownloadSearch" targetType="navTab" totalCount="0" numPerPage="0" pageNumShown="0" currentPage="0"></div>
	</div>
</div>
<script type="text/javascript">
	//定义默认参数
	var xmPadDeviceArgs={};
	 //查询方法
    xmPadDeviceDownloadSearch();
	function xmPadDeviceDownloadSearch(opt){
		//序列化表单值，并扩展到xmPadDeviceArgs对象中
		$.extend(xmPadDeviceArgs,findName('xmPadDeviceDownloadSearchForm').serializeJson(),opt?opt:{});
		//执行ajax查询方法
		doGetAjax(getURL(CPATH.domain_3,"/rs/xmPadDevice"),xmPadDeviceArgs,xmPadDeviceDownloadList);
	}
	
	//拼装
	function xmPadDeviceDownloadList(data){
		var sampleRow=findName('xmPadDeviceDownloadTrTemplate');
		pageResponse2Table(sampleRow,data);
        printPageBarDiv(findName('xmPadDeviceDownloadPageBar'),findName('xmPadDeviceDownloadCountDiv'),data.jsonData);
	}
	
	
	
	
	function xmPadDeviceDownloadDownload(){ 
		logger.info("xmMeetingInfoDownloadDownload begin");
		
		$("input[name='xmpdGuids']").each(function() {
			  var attrChecked=$(this).attr("checked");
			  var xmpdGuid=$(this).attr("value");
			   logger.info("each ......attrChecked===>"+attrChecked+"    xmpdGuid===>"+xmpdGuid);
			  if(attrChecked){
				  xmPadDeviceDownloadXmpdGuid(xmpdGuid);
			  }//end of if
			  
		}); 
		logger.info("xmMeetingInfoDownloadDownload end");
		
		
	}
	
	

	function xmPadDeviceDownloadXmpdGuid(xmpdGuid){
		logger.info("xmPadDeviceDownloadXmpdGuid begin  xmpdGuid====>"+xmpdGuid);
		var urlx=getURL(CPATH.domain_3,"/rs/xmPadDevice/"+xmpdGuid);
		
		
		dtdXHR = $.ajax({
			  type: "GET",
			  url: urlx,
			  dataType: "json",
			  cache:false,
			  global:false
		});
			
		dtdXHR.done(function(respJson){    
			logger.info("done--->"+respJson);
			
			var xmpdDeviceId=respJson.xmpdDeviceId; 
			
		 

			logger.info("xmpdDeviceId-->"+xmpdDeviceId);
			padinfoSendMsg(xmpdDeviceId);
			
			alertMsg.correct('设备信息发起下载已经提交成功！')
		
		});
		dtdXHR.fail(function(respJson){    
			logger.info("fail--->"+respJson);
		});
		
	}  
	

	function xmPadCompanyDownloadDownload(){ 
		logger.info("xmPadCompanyDownloadDownload begin"); 
		$("input[name='xmpdGuids']").each(function() {
			  var attrChecked=$(this).attr("checked");
			  var xmpdGuid=$(this).attr("value");
			  logger.info("each ......attrChecked===>"+attrChecked+"    xmpdGuid===>"+xmpdGuid);
			  if(attrChecked){
				  xmPadCompanyDownloadXmpdGuid(xmpdGuid);
			  }//end of if 
		}); 
		logger.info("xmPadCompanyDownloadDownload end"); 
	}
	
	

	function xmPadCompanyDownloadXmpdGuid(xmpdGuid){
		logger.info("xmPadCompanyDownloadXmpdGuid begin  xmpdGuid====>"+xmpdGuid);
		var urlx=getURL(CPATH.domain_3,"/rs/xmPadDevice/"+xmpdGuid);
		
		
		dtdXHR = $.ajax({
			  type: "GET",
			  url: urlx,
			  dataType: "json",
			  cache:false,
			  global:false
		});
			
		dtdXHR.done(function(respJson){    
			logger.info("done--->"+respJson);
			
			var xmpdDeviceId=respJson.xmpdDeviceId;  
			logger.info("xmpdDeviceId-->"+xmpdDeviceId);
			companyinfoSendMsg(xmpdDeviceId);
			
			alertMsg.correct('公司信息发起下载已经提交成功！')
		
		});
		dtdXHR.fail(function(respJson){    
			logger.info("fail--->"+respJson);
		});
		
	}
</script>